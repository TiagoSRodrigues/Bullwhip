import os
import numpy as np
import math
import pandas as pd
from pandas.plotting import autocorrelation_plot
from matplotlib import pyplot
import datetime

open_orders=[ [1, 3001, 101, 2, 3000001, 9, {}], [2, 3001, 103, 2, 3000002, 9, {}], [3, 3001, 104, 2, 3000003, 9, {}], [4, 3001, 104, 2, 3000004, 9, {}], [5, 3001, 103, 2, 3000005, 9, {}], [6, 3001, 102, 2, 3000006, 9, {}], [7, 3001, 103, 2, 3000007, 9, {}], [8, 3001, 103, 2, 3000008, 9, {}], [9, 3001, 103, 2, 3000009, 9, {}], [10, 3001, 102, 2, 3000010, 9, {}], [11, 3001, 101, 2, 3000011, 9, {}], [12, 3001, 101, 2, 3000012, 9, {}], [13, 3001, 101, 2, 3000013, 9, {}], [14, 3001, 101, 2, 3000014, 9, {}], [15, 3001, 101, 2, 3000015, 9, {}], [16, 3001, 100, 2, 3000016, 9, {}], [17, 3001, 100, 2, 3000017, 9, {}], [18, 3001, 100, 2, 3000018, 9, {}], [19, 3001, 100, 2, 3000019, 9, {}], [20, 3001, 98, 2, 3000020, 9, {}], [21, 3001, 98, 2, 3000021, 9, {}], [22, 3001, 97, 2, 3000022, 9, {}], [25, 3001, 98, 2, 3000025, 9, {}], [30, 3001, 98, 2, 3000030, 9, {}], [31, 3001, 99, 2, 3000031, 9, {}], [34, 3001, 99, 2, 3000034, 9, {}], [35, 3001, 99, 2, 3000035, 9, {}], [36, 3001, 99, 2, 3000036, 9, {}], [60, 3001, 97, 2, 3000043, 9, {}], [61, 3001, 97, 2, 3000044, 9, {}], [67, 3001, 95, 2, 3000045, 9, {}], [68, 3001, 97, 2, 3000046, 9, {}], [71, 3001, 96, 2, 3000047, 9, {}], [73, 3001, 96, 2, 3000048, 9, {}], [74, 3001, 95, 2, 3000049, 9, {}], [75, 3001, 95, 2, 3000050, 9, {}], [79, 3001, 94, 2, 3000052, 9, {}], [82, 3001, 93, 2, 3000053, 9, {}], [84, 3001, 92, 2, 3000054, 9, {}], [85, 3001, 91, 2, 3000055, 9, {}], [87, 3001, 91, 2, 3000056, 9, {}], [90, 3001, 90, 2, 3000058, 9, {}], [93, 3001, 91, 2, 3000061, 9, {}], [94, 3001, 91, 2, 3000062, 9, {}], [95, 3001, 90, 2, 3000063, 9, {}], [96, 3001, 91, 2, 3000064, 9, {}], [97, 3001, 91, 2, 3000065, 9, {}], [102, 3001, 91, 2, 3000067, 9, {}], [105, 3001, 91, 2, 3000070, 9, {}], [106, 3001, 93, 2, 3000071, 9, {}], [107, 3001, 94, 2, 3000072, 9, {}], [108, 3001, 93, 2, 3000073, 9, {}], [109, 3001, 93, 2, 3000074, 9, {}], [112, 3001, 95, 2, 3000075, 9, {}], [113, 3001, 96, 2, 3000076, 9, {}], [114, 3001, 97, 2, 3000077, 9, {}], [126, 3001, 93, 2, 3000083, 9, {}], [127, 3001, 94, 2, 3000084, 9, {}], [132, 3001, 95, 2, 3000085, 9, {}], [134, 3001, 95, 2, 3000086, 9, {}], [135, 3001, 95, 2, 3000087, 9, {}], [136, 3001, 95, 2, 3000088, 9, {}], [146, 3001, 93, 2, 3000092, 9, {}], [147, 3001, 94, 2, 3000093, 9, {}], [149, 3001, 94, 2, 3000095, 9, {}], [155, 3001, 90, 2, 3000096, 9, {}], [159, 3001, 90, 2, 3000099, 9, {}], [161, 3001, 90, 2, 3000100, 9, {}], [162, 3001, 91, 2, 3000101, 9, {}], [163, 3001, 91, 2, 3000102, 9, {}], [165, 3001, 91, 2, 3000103, 9, {}], [166, 3001, 90, 2, 3000104, 9, {}], [169, 3001, 90, 2, 3000105, 9, {}], [170, 3001, 90, 2, 3000106, 9, {}], [171, 3001, 90, 2, 3000107, 9, {}], [175, 3001, 89, 2, 3000110, 9, {}], [176, 3001, 90, 2, 3000111, 9, {}], [177, 3001, 89, 2, 3000112, 9, {}], [178, 3001, 88, 2, 3000113, 9, {}], [179, 3001, 87, 2, 3000114, 9, {}], [183, 3001, 87, 2, 3000115, 9, {}], [184, 3001, 87, 2, 3000116, 9, {}], [190, 3001, 89, 2, 3000121, 9, {}], [191, 3001, 88, 2, 3000122, 9, {}], [192, 3001, 88, 2, 3000123, 9, {}], [195, 3001, 88, 2, 3000126, 9, {}], [204, 3001, 86, 2, 3000128, 9, {}], [207, 3001, 85, 2, 3000129, 9, {}], [208, 3001, 85, 2, 3000130, 9, {}], [209, 3001, 84, 2, 3000131, 9, {}], [216, 3001, 85, 2, 3000133, 9, {}], [219, 3001, 86, 2, 3000136, 9, {}], [220, 3001, 87, 2, 3000137, 9, {}], [221, 3001, 87, 2, 3000138, 9, {}], [223, 3001, 86, 2, 3000139, 9, {}], [226, 3001, 86, 2, 3000142, 9, {}], [227, 3001, 86, 2, 3000143, 9, {}], [230, 3001, 85, 2, 3000144, 9, {}], [232, 3001, 85, 2, 3000145, 9, {}], [234, 3001, 84, 2, 3000146, 9, {}], [235, 3001, 84, 2, 3000147, 9, {}], [236, 3001, 84, 2, 3000148, 9, {}], [237, 3001, 86, 2, 3000149, 9, {}], [242, 3001, 88, 2, 3000150, 9, {}], [245, 3001, 89, 2, 3000153, 9, {}], [246, 3001, 88, 2, 3000154, 9, {}], [247, 3001, 88, 2, 3000155, 9, {}], [253, 3001, 91, 2, 3000160, 9, {}], [258, 3001, 93, 2, 3000161, 9, {}], [264, 3001, 95, 2, 3000162, 9, {}], [265, 3001, 95, 2, 3000163, 9, {}], [271, 3001, 94, 2, 3000166, 9, {}], [272, 3001, 94, 2, 3000167, 9, {}], [274, 3001, 94, 2, 3000168, 9, {}], [275, 3001, 94, 2, 3000169, 9, {}], [276, 3001, 93, 2, 3000170, 9, {}], [278, 3001, 93, 2, 3000171, 9, {}], [284, 3001, 94, 2, 3000173, 9, {}], [287, 3001, 93, 2, 3000175, 9, {}], [288, 3001, 93, 2, 3000176, 9, {}], [289, 3001, 92, 2, 3000177, 9, {}], [291, 3001, 93, 2, 3000178, 9, {}], [292, 3001, 93, 2, 3000179, 9, {}], [299, 3001, 91, 2, 3000184, 9, {}], [300, 3001, 91, 2, 3000185, 9, {}], [301, 3001, 91, 2, 3000186, 9, {}], [304, 3001, 93, 2, 3000187, 9, {}], [305, 3001, 94, 2, 3000188, 9, {}], [306, 3001, 93, 2, 3000189, 9, {}], [310, 3001, 94, 2, 3000191, 9, {}], [311, 3001, 93, 2, 3000192, 9, {}], [313, 3001, 92, 2, 3000193, 9, {}], [322, 3001, 90, 2, 3000196, 9, {}], [324, 3001, 88, 2, 3000197, 9, {}], [326, 3001, 88, 2, 3000198, 9, {}], [327, 3001, 88, 2, 3000199, 9, {}], [329, 3001, 90, 2, 3000200, 9, {}], [331, 3001, 90, 2, 3000201, 9, {}], [339, 3001, 88, 2, 3000207, 9, {}], [341, 3001, 90, 2, 3000208, 9, {}], [342, 3001, 90, 2, 3000209, 9, {}], [354, 3001, 89, 2, 3000212, 9, {}], [355, 3001, 88, 2, 3000213, 9, {}], [356, 3001, 87, 2, 3000214, 9, {}], [357, 3001, 88, 2, 3000215, 9, {}], [358, 3001, 88, 2, 3000216, 9, {}], [360, 3001, 88, 2, 3000217, 9, {}], [364, 3001, 86, 2, 3000218, 9, {}], [366, 3001, 86, 2, 3000219, 9, {}], [367, 3001, 86, 2, 3000220, 9, {}], [370, 3001, 85, 2, 3000223, 9, {}], [371, 3001, 85, 2, 3000224, 9, {}], [375, 3001, 85, 2, 3000226, 9, {}], [377, 3001, 85, 2, 3000227, 9, {}], [379, 3001, 85, 2, 3000229, 9, {}], [380, 3001, 87, 2, 3000230, 9, {}], [381, 3001, 86, 2, 3000231, 9, {}], [382, 3001, 86, 2, 3000232, 9, {}], [391, 3001, 85, 2, 3000237, 9, {}], [392, 3001, 85, 2, 3000238, 9, {}], [396, 3001, 85, 2, 3000239, 9, {}], [400, 3001, 85, 2, 3000240, 9, {}], [402, 3001, 85, 2, 3000241, 9, {}], [403, 3001, 86, 2, 3000242, 9, {}], [409, 3001, 88, 2, 3000245, 9, {}], [410, 3001, 88, 2, 3000246, 9, {}], [411, 3001, 88, 2, 3000247, 9, {}], [412, 3001, 88, 2, 3000248, 9, {}], [413, 3001, 88, 2, 3000249, 9, {}], [414, 3001, 88, 2, 3000250, 9, {}], [415, 3001, 88, 2, 3000251, 9, {}], [416, 3001, 88, 2, 3000252, 9, {}], [417, 3001, 88, 2, 3000253, 9, {}], [418, 3001, 88, 2, 3000254, 9, {}], [421, 3001, 90, 2, 3000255, 9, {}], [422, 3001, 90, 2, 3000256, 9, {}], [426, 3001, 91, 2, 3000260, 9, {}], [432, 3001, 90, 2, 3000263, 9, {}], [433, 3001, 91, 2, 3000264, 9, {}], [435, 3001, 92, 2, 3000265, 9, {}], [442, 3001, 90, 2, 3000267, 9, {}], [445, 3001, 92, 2, 3000269, 9, {}], [448, 3001, 93, 2, 3000272, 9, {}], [449, 3001, 93, 2, 3000273, 9, {}], [458, 3001, 92, 2, 3000276, 9, {}], [462, 3001, 92, 2, 3000278, 9, {}], [463, 3001, 91, 2, 3000279, 9, {}], [464, 3001, 91, 2, 3000280, 9, {}], [466, 3001, 91, 2, 3000281, 9, {}], [467, 3001, 91, 2, 3000282, 9, {}], [469, 3001, 90, 2, 3000283, 9, {}], [470, 3001, 90, 2, 3000284, 9, {}], [475, 3001, 89, 2, 3000285, 9, {}], [477, 3001, 91, 2, 3000287, 9, {}], [478, 3001, 90, 2, 3000288, 9, {}], [479, 3001, 91, 2, 3000289, 9, {}], [480, 3001, 91, 2, 3000290, 9, {}], [481, 3001, 90, 2, 3000291, 9, {}], [482, 3001, 90, 2, 3000292, 9, {}], [491, 3001, 88, 2, 3000297, 9, {}], [492, 3001, 88, 2, 3000298, 9, {}], [498, 3001, 88, 2, 3000301, 9, {}], [499, 3001, 89, 2, 3000302, 9, {}], [500, 3001, 89, 2, 3000303, 9, {}], [509, 3001, 90, 2, 3000306, 9, {}], [510, 3001, 90, 2, 3000307, 9, {}], [511, 3001, 90, 2, 3000308, 0, {}]] 

orders_array = np.array(open_orders[-0:])
orders_array=orders_array[:,2]


# # p: The number of lag observations included in the model, also called the lag order.
# # d: The number of times that the raw observations are differenced, also called the degree of differencing.
# # q: The size of the moving average window, also called the order of moving average.


from statsmodels.tsa.arima.model import ARIMA
from matplotlib import pyplot
# load dataset


# series=np.asarray(df,dtype=np.int32)
data_file='N:\\TESE\\Bullwhip\\data\\input\\data_amplified.csv'



series = pd.read_csv(data_file)
def add_timeseries(array):
	# create dummy dates for the arima modules....
	dates = pd.date_range('1900-1-1', periods=len(array), freq='D')
	print(dates)
	# add the dates and the data to a new dataframe
	ts = pd.DataFrame({'dates': dates, 'value': array})
	ts["value"]=ts["value"].astype(int)
 	# set the dataframe index to be the dates column
	return  ts.set_index('dates')

x=add_timeseries(series["value"])

autoplot(euretail) + ylab("Retail index") + xlab("Year")


x.plot()
pyplot.show()
